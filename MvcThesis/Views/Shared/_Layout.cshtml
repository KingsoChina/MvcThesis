<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title - 毕业论文管理系统</title>
    <meta http-equiv="X-UA-Compatible" content="IE =edge,chrome =1" />
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport' />
    <!--[if lt IE 9]>
    <script src='~/Content/assets/javascripts/html5shiv.js' type='text/javascript'></script>
    <![endif]-->
    <link href='~/Content/assets/stylesheets/bootstrap/bootstrap.css' media='all' rel='stylesheet' type='text/css' />
    <link href='~/Content/assets/stylesheets/bootstrap/bootstrap-responsive.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / jquery ui -->
    <link href='~/Content/assets/stylesheets/jquery_ui/jquery-ui-1.10.0.custom.css' media='all' rel='stylesheet' type='text/css' />
    <link href='~/Content/assets/stylesheets/jquery_ui/jquery.ui.1.10.0.ie.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / xeditable -->
    <link href='~/Content/assets/stylesheets/plugins/xeditable/bootstrap-editable.css' media='all' rel='stylesheet' type='text/css' />
    <link href='~/Content/assets/stylesheets/plugins/common/bootstrap-wysihtml5.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / wysihtml5 (wysywig) -->
    <link href='~/Content/assets/stylesheets/plugins/common/bootstrap-wysihtml5.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / jquery file upload -->
    <link href='~/Content/assets/stylesheets/plugins/jquery_fileupload/jquery.fileupload-ui.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / full calendar -->
    <link href='~/Content/assets/stylesheets/plugins/fullcalendar/fullcalendar.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / select2 -->
    <link href='~/Content/assets/stylesheets/plugins/select2/select2.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / mention -->
    <link href='~/Content/assets/stylesheets/plugins/mention/mention.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / tabdrop (responsive tabs) -->
    <link href='~/Content/assets/stylesheets/plugins/tabdrop/tabdrop.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / jgrowl notifications -->
    <link href='~/Content/assets/stylesheets/plugins/jgrowl/jquery.jgrowl.min.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / datatables -->
    <link href='~/Content/assets/stylesheets/plugins/datatables/bootstrap-datatable.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / dynatrees (file trees) -->
    <link href='~/Content/assets/stylesheets/plugins/dynatree/ui.dynatree.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / datetime picker -->
    <link href='~/Content/assets/stylesheets/plugins/bootstrap_datetimepicker/bootstrap-datetimepicker.min.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / daterange picker) -->
    <link href='~/Content/assets/stylesheets/plugins/bootstrap_daterangepicker/bootstrap-daterangepicker.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / fuelux (wizard) -->
    <link href='~/Content/assets/stylesheets/plugins/fuelux/wizard.css' media='all' rel='stylesheet' type='text/css' />
    <!-- / flatty theme -->
    <link href='~/Content/assets/stylesheets/light-theme.css' id='color-settings-body-color' media='all' rel='stylesheet' type='text/css' />
    <!-- / demo -->
    <link href='~/Content/assets/stylesheets/demo.css' media='all' rel='stylesheet' type='text/css' />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body class='contrast-red '>
    <header>
        @Html.Partial("_HeaderPartial")
    </header>
    <div id='wrapper'>
        <div id='main-nav-bg'></div>
        <nav class='' id='main-nav'>
            <div class='navigation'>
                @Html.Partial("_NavPartial")
            </div>
        </nav>
        <section id='content'>
            <div class='container-fluid'>
                <div class='row-fluid' id='content-wrapper'>
                    <div class='span12'>
                        <div class="row-fluid" id="content-title">
                            <div class="span12">
                                <div class="page-header">
                                    <h1 class="pull-left">
                                        @*<i class="icon-edit"></i>*@
                                        <span> 毕业论文管理系统 - @ViewBag.Title</span>
                                    </h1>
                                </div>
                            </div>
                        </div>
                        <!--BodyStart-->@RenderBody()<!--BodyEnd-->

                        <div class="modal hide fade" id="modal" role="dialog" tabindex="-1" aria-hidden="true">
                            <div class="modal-header">
                                <button class="close" data-dismiss="modal" type="button">×</button>
                                <h3>编辑资料</h3>
                            </div>
                            <div class="modal-body">

                            </div>
                            <div class="modal-footer">
                                <button class="btn" data-dismiss="modal">关闭</button>
                                <button class="btn btn-primary" id="modalSub">提交</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- / jquery -->
    @*<script src='~/Content/assets/javascripts/jquery/jquery.min.js' type='text/javascript'></script>*@
    @Scripts.Render("~/bundles/jquery")
    <!-- / jquery mobile events (for touch and slide) -->
    <script src='~/Content/assets/javascripts/plugins/mobile_events/jquery.mobile-events.min.js' type='text/javascript'></script>
    <!-- / jquery migrate (for compatibility with new jquery) -->
    <script src='~/Content/assets/javascripts/jquery/jquery-migrate.min.js' type='text/javascript'></script>
    <!-- / jquery ui -->
    <script src='~/Content/assets/javascripts/jquery_ui/jquery-ui.min.js' type='text/javascript'></script>
    <!-- / bootstrap -->
    <script src='~/Content/assets/javascripts/bootstrap/bootstrap.min.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/flot/excanvas.js' type='text/javascript'></script>

    <!-- / sparklines -->
    <script src='~/Content/assets/javascripts/plugins/sparklines/jquery.sparkline.min.js' type='text/javascript'></script>
    <!-- / flot charts -->
    <script src='~/Content/assets/javascripts/plugins/flot/flot.min.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/flot/flot.resize.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/flot/flot.pie.js' type='text/javascript'></script>
    <!-- / datatables -->
    <script src='~/Content/assets/javascripts/plugins/datatables/jquery.dataTables.min.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/datatables/jquery.dataTables.columnFilter.js' type='text/javascript'></script>
    <!-- / wysihtml5 -->
    <script src='~/Content/assets/javascripts/plugins/common/wysihtml5.min.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/common/bootstrap-wysihtml5.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/common/bootstrap-wysihtml5.zh-CN.js' type='text/javascript'></script>
    <!-- / select2 -->
    <script src='~/Content/assets/javascripts/plugins/select2/select2.js' type='text/javascript'></script>
    <!-- / color picker -->
    <script src='~/Content/assets/javascripts/plugins/bootstrap_colorpicker/bootstrap-colorpicker.min.js' type='text/javascript'></script>
    <!-- / mention -->
    <script src='~/Content/assets/javascripts/plugins/mention/mention.min.js' type='text/javascript'></script>
    <!-- / input mask -->
    <script src='~/Content/assets/javascripts/plugins/input_mask/bootstrap-inputmask.min.js' type='text/javascript'></script>
    <!-- / modernizr -->
    <script src='~/Content/assets/javascripts/plugins/modernizr/modernizr.min.js' type='text/javascript'></script>
    <!-- / retina -->
    <script src='~/Content/assets/javascripts/plugins/retina/retina.js' type='text/javascript'></script>
    <!-- / timeago -->
    <script src='~/Content/assets/javascripts/plugins/timeago/jquery.timeago.js' type='text/javascript'></script>
    <!-- / slimscroll -->
    <script src='~/Content/assets/javascripts/plugins/slimscroll/jquery.slimscroll.min.js' type='text/javascript'></script>
    <!-- / autosize (for textareas) -->
    <script src='~/Content/assets/javascripts/plugins/autosize/jquery.autosize-min.js' type='text/javascript'></script>
    <!-- / charCount -->
    <script src='~/Content/assets/javascripts/plugins/charCount/charCount.js' type='text/javascript'></script>
    <!-- / validate -->
    <script src='~/Content/assets/javascripts/plugins/validate/jquery.validate.min.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/plugins/validate/additional-methods.js' type='text/javascript'></script>
    <!-- / naked password -->
    <script src='~/Content/assets/javascripts/plugins/naked_password/naked_password-0.2.4.min.js' type='text/javascript'></script>
    <!-- / nestable -->
    <script src='~/Content/assets/javascripts/plugins/nestable/jquery.nestable.js' type='text/javascript'></script>
    <!-- / tabdrop -->
    <script src='~/Content/assets/javascripts/plugins/tabdrop/bootstrap-tabdrop.js' type='text/javascript'></script>
    <!-- / jgrowl -->
    <script src='~/Content/assets/javascripts/plugins/jgrowl/jquery.jgrowl.min.js' type='text/javascript'></script>
    <!-- / bootbox -->
    <script src='~/Content/assets/javascripts/plugins/bootbox/bootbox.min.js' type='text/javascript'></script>
    <!-- / datetime picker -->
    <script src='~/Content/assets/javascripts/plugins/bootstrap_datetimepicker/bootstrap-datetimepicker.js' type='text/javascript'></script>
    <!-- / fuelux -->
    <script src='~/Content/assets/javascripts/plugins/fuelux/wizard.js' type='text/javascript'></script>

    <!-- / max length -->
    <script src='~/Content/assets/javascripts/plugins/bootstrap_maxlength/bootstrap-maxlength.min.js' type='text/javascript'></script>
    <!-- / dropdown hover -->
    <script src='~/Content/assets/javascripts/plugins/bootstrap_hover_dropdown/twitter-bootstrap-hover-dropdown.min.js' type='text/javascript'></script>
    @Scripts.Render("~/bundles/jqueryform")

    <!-- / flatty theme -->
    <script src='~/Content/assets/javascripts/nav.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/tables.js' type='text/javascript'></script>
    <script src='~/Content/assets/javascripts/theme.js' type='text/javascript'></script>
    @RenderSection("js", false)
    <script src="~/Scripts/jquery.uploadifive.min.js"></script>
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        var lessThenIE9 = function () {
            var UA = navigator.userAgent,
                isIE = UA.indexOf('MSIE') > -1,
                v = isIE ? /\d+/.exec(UA.split(';')[1]) : 'no ie';
            return v < 9;
        }();
        (function ($) {
            $(".btn-modal").live("click", function () {
                $modal = $("#modal");
                var title = $(this).attr("data-title"),
                    url = $(this).attr("data-url"),
                    callback = $(this).attr("data-callback"),
                    id = $(this).attr("data-id"),
                    load_html = "<div style=\"width:100%;text-align:center;\"><img alt=\"加载中\" src=\"@Url.Content("~/Content/assets/images/ajax-loaders/11.gif")\" style=\"margin:auto;\"></div>";
                $modal.children(".modal-body").html(load_html);
                $.get(url, { id: id }, function (data) {
                    if (data.status == 0)
                    {
                        data.msg && $.jGrowl(data.msg);
                        return;
                    }
                    $modal.children(".modal-header").children("h3").html(title);//标题
                    $modal.children(".modal-body").html(data);//表单内容
                    $.validator.unobtrusive.parse(".modal-body form");//重新绑定验证
                    setSelect2();
                    var re = /(\u4fee\u6539)/g;
                    if (re.test(title)) {
                        $(".modal-footer .btn").first().html("\u653e\u5f03");
                        $(".modal-footer .btn").last().html("\u4fdd\u5b58");
                    } else {
                        $(".modal-footer .btn").first().html("\u53d6\u6d88");
                        $(".modal-footer .btn").last().html("\u63d0\u4ea4");
                    }
                    $modal.modal();

                });

            });
            $(".modal-body form").ajaxForm({
                delegation: true,
                success: function (data) {
                    if (data.status == 1) {
                        $("#modal").modal("hide");
                        reload();
                    }
                    data.msg && $.jGrowl(data.msg);
                }
            });
            $(".ajax-form").ajaxForm({
                delegation: true,
                success: function (data) {
                    if (data.status == 1) {
                        setTimeout(function () {
                            window.location.reload();
                        }, 2000);
                    }
                    data.msg && $.jGrowl(data.msg);
                }
            });
            $(".update-form").ajaxForm({
                delegation: true,
                success: function (data) {
                    data.msg && $.jGrowl(data.msg);
                }
            });
            $("#modalSub").live("click", function () {
                $("#modal form") && $("#modal form").submit();
                //$("#modal form").length || $("#modal").modal("hide");
            });
            $(".form-actions .btn").live("click", function () {
                $(".ajax-form").submit();
            });
            //删除按钮
            $(".btn-del").live("click", function () {
                var url = $(this).attr("data-url"),
                    id = $(this).attr("data-id"),
                    content = $(this).attr("data-content");
                return bootbox.confirm(content || "确认删除?", function (result) {
                    if (result === true) {
                        $.post(url, { id: id }, function (data) {
                            if (data.status == 1) {
                                $(this).parents("tr").remove();
                                reload();
                                data.msg && $.jGrowl(data.msg);
                            }
                        });
                    }
                });
            });
            //确认按钮（刷新页面）
            $(".btn-confirm").live("click", function () {
                var url = $(this).attr("data-url"),
                    id = $(this).attr("data-id"),
                    content = $(this).attr("data-content");
                bootbox.setLocale("zn");
                return bootbox.confirm(content, function (result) {
                    if (result === true) {
                        $.post(url, { id: id, ajax: 1 }, function (data) {
                            if (data.status == 1) {
                                setTimeout(function () {
                                    reload();
                                }, 2000);
                            }
                            data.msg && $.jGrowl(data.msg);
                        });
                    }
                });
            });
            $(".show-modal").live("click", function () {
                var url = $(this).attr("data-url");
                var id = $(this).attr("data-id");
                $.post(url, { id: id }, function (data) {
                    return bootbox.dialog(data, [
                                       {
                                           label: "确定",
                                           "class": "btn-info"
                                       }
                    ]);
                    data.msg && $.jGrowl(data.msg);
                });
            });
            $(".btn-update").live("click", function () {
                $(this).parents(".update-form").submit();
            });
        })($);
        //异步刷新主窗口
        function reload() {
            if (lessThenIE9) window.location.reload();
            $.get(document.location.href, { ajax: 1 }, function (html) {
                //html = html.replace(/<!--BodyEnd-->([\w\W]*)/, "");
                //html = html.replace(/([\w\W]*)<!--BodyStart-->/, "");
                //console.log(html);
                $("#content-title").next().remove();
                $("#content-title").after(html);
                //if ($(".data-table").dataTable.isDataTable()) { $(".data-table").dataTable().fnDestroy(); }
                //if ($(".data-table-column-filter").dataTable.isDataTable()) { $(".data-table-column-filter").dataTable().fnDestroy(); }
                setDataTable($(".data-table"));
                setDataTable($(".data-table-column-filter")).columnFilter();
            });
        }

    </script>
    @RenderSection("scripts", required: false)
</body>
</html>